

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Slurm examples &mdash; Northeastern University Research Computing 0.0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'0.0.2',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with GPUs" href="workingwithgpu.html" />
    <link rel="prev" title="Using Slurm" href="usingslurm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/NU_logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Welcome</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../welcome/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../welcome/gettinghelp.html">Getting Help</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started with Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/get_access.html">Getting Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/recommended_tools.html">Recommended Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/connect.html">Connecting to Discovery</a></li>
</ul>
<p class="caption"><span class="caption-text">Hardware on Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_overview.html">Hardware overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/partitions.html">Partitions</a></li>
</ul>
<p class="caption"><span class="caption-text">Software on Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../software/modules.html">Using Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/software.html">Installing Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/matlab.html">Working with MATLAB Parallel Computing Toolbox</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Discovery</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usingslurm.html">Using Slurm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Slurm examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#srun-examples"><code class="docutils literal notranslate"><span class="pre">SRUN</span></code> Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-simple-interactive-session">A simple interactive session</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-interactive-session-paramters">Specifying interactive session paramters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#allocating-a-gpu-node">Allocating a GPU node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-interactive-session-commands">Other interactive session commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sbatch-examples">SBATCH Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#core-job">Core job</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-job-and-additional-memory">Core job and additional memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-job-with-exclusive-use-of-a-node">Core job with exclusive use of a node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-parallel-job-scripts">Example Parallel Job Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-job-one-node-and-additional-memory">Task job, one node and additional memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-job-multiple-nodes-and-additional-memory">Task job, multiple nodes and additional memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-arrays">Using Arrays</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workingwithgpu.html">Working with GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="transferringdata.html">Transferring Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="globus.html">Using Globus</a></li>
</ul>
<p class="caption"><span class="caption-text">Understanding storage options</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../storage/discovery_storage.html">Storage Accessible on  Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/general_storage.html">General Data Storage Options</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Open OnDemand (OOD)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/introduction.html">Introduction to Open OnDemand (OOD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/fileexplore.html">Using OOD’s File Explorer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/interactiveapps.html">Using OOD’s Interactive Apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Discovery in your classroom</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../classroom/class_use.html">Using Discovery with your class FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Northeastern University Research Computing</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Slurm examples</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="slurm-examples">
<span id="id1"></span><h1>Slurm examples<a class="headerlink" href="#slurm-examples" title="Permalink to this headline">¶</a></h1>
<p>You can submit jobs using <code class="docutils literal notranslate"><span class="pre">srun</span></code> or <code class="docutils literal notranslate"><span class="pre">sbatch</span></code>. <code class="docutils literal notranslate"><span class="pre">srun</span></code> is for submitting interactive jobs, while you use <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> with a script.
You should review the examples on this page to have a general understanding of the types
of jobs you can submit to the scheduler.</p>
<p>Refer to the official Slurm documentation for more information about these
commands and their options: <a class="reference external" href="https://slurm.schedmd.com">https://slurm.schedmd.com</a>.</p>
<div class="section" id="srun-examples">
<h2><code class="docutils literal notranslate"><span class="pre">SRUN</span></code> Examples<a class="headerlink" href="#srun-examples" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="https://slurm.schedmd.com/srun.html">srun</a> from the terminal (see: <a class="reference internal" href="../get_started/connect.html#intro-connect"><span class="std std-ref">Connecting to Discovery</span></a>) to start an interactive job.</p>
<div class="section" id="a-simple-interactive-session">
<h3>A simple interactive session<a class="headerlink" href="#a-simple-interactive-session" title="Permalink to this headline">¶</a></h3>
<p>A simple <code class="docutils literal notranslate"><span class="pre">srun</span></code> example is to move to a compute node after you first log into Discovery.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[&lt;USERNAME&gt;@login-00 ~]$</span> srun --pty /bin/bash
</pre></div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">$</span></code> and everything before it is what you will see at the command line in the terminal. You do not need to type that, it is showing you your username and the machine you are SSH’d into.</p>
<p><strong>Explanation of command:</strong></p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">srun</span></code> - Run a slurm job.</li>
<li><code class="docutils literal notranslate"><span class="pre">--pty</span> <span class="pre">/bin/bash</span></code> - After provisioning the job, move the terminal to into the new node.</li>
</ul>
</div></blockquote>
<p>After running this command you should see that the job has been submitted</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">srun: job &lt;JOB_NUMBER&gt; queued and waiting for resources</span>
</pre></div>
</div>
<p>and then after a few moments, the job should start after the resources have been allocated</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">srun: job &lt;JOB_NUMBER&gt; has been allocated resources</span>
<span class="gp">[&lt;USERNAME&gt;@&lt;COMPUTE_NODE&gt; ~]$</span>
</pre></div>
</div>
<p>Note how the text before the <code class="docutils literal notranslate"><span class="pre">$</span></code> changed, indicating that the terminal switched from the log-in remote machine to the compute node provisioned for this interactive job. From here you can execute your compute commands on the compute node.</p>
</div>
<div class="section" id="specifying-interactive-session-paramters">
<h3>Specifying interactive session paramters<a class="headerlink" href="#specifying-interactive-session-paramters" title="Permalink to this headline">¶</a></h3>
<p>The number of nodes, cores, run time, X11 forwarding, memory, and gpus can all be controlled with the <code class="docutils literal notranslate"><span class="pre">srun</span></code> command.</p>
<p>To allocate one node (N 2), one core (n 3) for 30 minutes with X11 forwarding on the short partition (p short), type.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> srun -p short --export<span class="o">=</span>ALL -n <span class="m">2</span> -N <span class="m">3</span> --mem<span class="o">=</span>10Gb --time<span class="o">=</span><span class="m">00</span>:30:00 --x11 --pty /bin/bash
</pre></div>
</div>
<p><strong>Explanation of command:</strong></p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">srun</span></code> - Run a slurm job.</li>
<li><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">short</span></code> - Request the <code class="docutils literal notranslate"><span class="pre">short</span></code>  partition (i.e., type of compute node) for the resource allocation. Different resources will be available on different types of partitions. See :ref:partition_names for a list of partitions available on Discovery</li>
<li><code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">3</span></code> - Specify that three tasks will be run, so specify at least 3 CPU cores.</li>
<li><code class="docutils literal notranslate"><span class="pre">-N</span> <span class="pre">2</span></code> - Specify that two compute nodes should be provisioned.</li>
<li><code class="docutils literal notranslate"><span class="pre">--mem=10Gb</span></code> - Specify that a minimum of 410GB of memory should be allocated to the job.</li>
<li><code class="docutils literal notranslate"><span class="pre">--time=00:30:00</span></code> - The job will request only 30 minutes of wall clock run time, after which the job will be automatically terminated.</li>
<li><code class="docutils literal notranslate"><span class="pre">--x11</span></code> - Enable graphical interfaces to be forwared through the SSH connection using the <a class="reference external" href="https://en.wikipedia.org/wiki/X_Window_System">X Window System</a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">--export=ALL</span></code> - Export all of the users environment variables to the loaded environment. (This is the default behavior and probably not necessary.)</li>
<li><code class="docutils literal notranslate"><span class="pre">--pty</span> <span class="pre">/bin/bash</span></code> - After provisioning the job, move the terminal to into the new node.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="allocating-a-gpu-node">
<h3>Allocating a GPU node<a class="headerlink" href="#allocating-a-gpu-node" title="Permalink to this headline">¶</a></h3>
<p>To allocate a GPU node, you should specify the <code class="docutils literal notranslate"><span class="pre">gpu</span></code> partition and use the –gres option</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> srun -p gpu --gres<span class="o">=</span>gpu:1 --pty /bin/bash
</pre></div>
</div>
<p><strong>Explanation of command:</strong></p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">srun</span></code> - Run a slurm job.</li>
<li><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">gpu</span></code> - Request a <code class="docutils literal notranslate"><span class="pre">gpu</span></code> partition</li>
<li><code class="docutils literal notranslate"><span class="pre">--gres=gpu:1</span></code> - Request one gpu resource</li>
<li><code class="docutils literal notranslate"><span class="pre">--pty</span> <span class="pre">/bin/bash</span></code> - After provisioning the job, move the terminal to into the new node.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="other-interactive-session-commands">
<h3>Other interactive session commands<a class="headerlink" href="#other-interactive-session-commands" title="Permalink to this headline">¶</a></h3>
<p>Note that you need to use <code class="docutils literal notranslate"><span class="pre">squeue</span> <span class="pre">-u</span> <span class="pre">&lt;yourusername&gt;</span></code> after you submit an interactive job
to view the job.</p>
<p>When Discovery has maintenance, you can specify the <code class="docutils literal notranslate"><span class="pre">t2sd</span></code> (“time to shutdown”) script with the <code class="docutils literal notranslate"><span class="pre">--time</span></code> option along with your usual SRUN options</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> srun --time<span class="o">=</span><span class="k">$(</span> t2sd <span class="k">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sbatch-examples">
<h2>SBATCH Examples<a class="headerlink" href="#sbatch-examples" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://slurm.schedmd.com/sbatch.html">sbatch</a> will submit a batch script to Slurm to run without showing an interactive terminal to the user.</p>
<div class="section" id="core-job">
<h3>Core job<a class="headerlink" href="#core-job" title="Permalink to this headline">¶</a></h3>
<p>Run a 1-core job for 4 hours on the short partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH –nodes=1</span>
<span class="c1">#SBATCH –time=4:00:00</span>
<span class="c1">#SBATCH –job-name=MyJobName</span>
<span class="c1">#SBATCH –partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="core-job-and-additional-memory">
<h3>Core job and additional memory<a class="headerlink" href="#core-job-and-additional-memory" title="Permalink to this headline">¶</a></h3>
<p>The default memory per allocated core is 1GB. If your calculations try to use
more memory than what is allocated, Slurm automatically terminates your job.
You should request a specific amount of memory in your job script if your
calculations need more memory than the default. The example script below is
requesting 100GB of memory (mem=100Gb).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100Gb</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="core-job-with-exclusive-use-of-a-node">
<h3>Core job with exclusive use of a node<a class="headerlink" href="#core-job-with-exclusive-use-of-a-node" title="Permalink to this headline">¶</a></h3>
<p>If you need exclusive use of a node, such as when you have a job that has high
I/O requirements, you can use the exclusive flag. The example script below
specifies exclusive use of 1 node in the short partition for four hours.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --exclusive</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-parallel-job-scripts">
<h2>Example Parallel Job Scripts<a class="headerlink" href="#example-parallel-job-scripts" title="Permalink to this headline">¶</a></h2>
<p>Parallel jobs should be used with code that is configured to use the reserved resources.
If your code is not optimized for running in parallel, your job could fail.
The following script examples all allocate additional memory.
The default memory per allocated core is 1GB. If your calculations try to use more
memory than what is allocated, Slurm automatically terminates your job.
You should request a specific amount of memory in your job script if your calculations
need more memory than the default.</p>
<div class="section" id="task-job-one-node-and-additional-memory">
<h3>Task job, one node and additional memory<a class="headerlink" href="#task-job-one-node-and-additional-memory" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --tasks-per-node=8</span>
<span class="c1">#SBATCH --cpus-per-task=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100Gb</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="task-job-multiple-nodes-and-additional-memory">
<h3>Task job, multiple nodes and additional memory<a class="headerlink" href="#task-job-multiple-nodes-and-additional-memory" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=4</span>
<span class="c1">#SBATCH --tasks-per-node=2</span>
<span class="c1">#SBATCH --cpus-per-task=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100Gb</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-arrays">
<h2>Using Arrays<a class="headerlink" href="#using-arrays" title="Permalink to this headline">¶</a></h2>
<p>Using a job array can often help in situations where you need to submit multiple similar jobs.
To use an array with your jobs, in your sbatch script, use the <code class="docutils literal notranslate"><span class="pre">array=</span></code> option.</p>
<p>For example, if you want to run a 10 job array, one job at a time, you would add the following
line to your sbatch script:</p>
<p><code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--array=1-10%1</span></code></p>
<p>Go <a class="reference external" href="https://slurm.schedmd.com/job_array.html">here</a> for more information about using the
<code class="docutils literal notranslate"><span class="pre">array=</span></code> option.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="workingwithgpu.html" class="btn btn-neutral float-right" title="Working with GPUs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="usingslurm.html" class="btn btn-neutral float-left" title="Using Slurm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020, Northeastern University Research Computing

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>